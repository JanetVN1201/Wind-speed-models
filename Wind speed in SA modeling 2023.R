###MH De Bie Masters 2023### FULL MODELLING CODE FOR ALL RESULTSrm(list = ls(all.names = TRUE)) options(max.print = .Machine$integer.max)gc() library(INLA)library(leaflet)library(ggplot2)library(sf)library("rnaturalearth")library("rnaturalearthdata")library(fields)library(readr)library(raster)library(modeest)library(dplyr)setwd("~/Data")sample_1=read_csv("PRIME_DATA_SET.csv")sample_Q = slice_sample(sample_1, n = 50000)n=nrow(sample_Q)p=ncol(sample_Q)sample_Q$Wind_Speed=as.numeric(sample_Q$Wind_Speed)str(sample_Q)nn=nrow(sample_Q)pp=ncol(sample_Q)sample_Q=sample_Q[,2:pp]#Preparing a Spatial Component.#Latitude Componentlatitude = sample_Q$Station_IDlatitude[latitude == "WM01"] = -28.583331latitude[latitude == "WM02"] = -31.47069latitude[latitude == "WM03"] = -31.639122latitude[latitude == "WM04"] = -32.8999964latitude[latitude == "WM05"] = -34.4666648 latitude[latitude == "WM06"] = -32.374331836 latitude[latitude == "WM07"] = -33.2166658 latitude[latitude == "WM08"] = -34.0027latitude[latitude == "WM09"] = -31.18736latitude[latitude == "WM10"] = -32.33083sample_Q$latitude=latitude#Longitude Componentlongitude = sample_Q$Station_IDlongitude[longitude == "WM01"] = 16.4833314longitude[longitude == "WM02"] = 19.77601longitude[longitude == "WM03"] = 18.5285longitude[longitude == "WM04"] = 17.9833294longitude[longitude == "WM05"] = 19.8999964longitude[longitude == "WM06"] = 20.806413441longitude[longitude == "WM07"] = 22.0333332longitude[longitude == "WM08"] = 24.7440longitude[longitude == "WM09"] = 24.94991longitude[longitude == "WM10"] = 28.14981sample_Q$longitude=longitude#Creating Meshes for Practical Selectionkk=ncol(sample_Q)sample_Q[, (kk-1):kk] <- sapply(sample_Q[, (kk-1):kk], as.numeric)sample_Q$lat_jit=jitter(sample_Q$latitude, factor = 1, amount = 0.65)sample_Q$lon_jit=jitter(sample_Q$longitude, factor = 1, amount = 0.65)sampleQ1 = sample_Q[complete.cases(sample_Q),]sample_Q <- sampleQ1# show map with Latitude 200 as centercc=ncol(sample_Q)coords <- cbind( as.matrix(sample_Q$lon_jit), as.matrix(sample_Q$lat_jit) )pl.dom <- cbind(c(15, 35), c(-35,-20))#MESH_Emesh5 <- inla.mesh.2d(loc.domain = pl.dom, coords,max.edge = c(0.55, 0.55), offset = c(0.15, 0.15), cutoff = c(0.55))plot(mesh5)             sample_Q = slice_sample(sample_1, n = 500000)n=nrow(sample_Q)p=ncol(sample_Q)sample_Q$Wind_Speed=as.numeric(sample_Q$Wind_Speed)str(sample_Q)nn=nrow(sample_Q)pp=ncol(sample_Q)sample_Q=sample_Q[,2:pp]#Preparing a Spatial Component.#Latitude Componentlatitude = sample_Q$Station_IDlatitude[latitude == "WM01"] = -28.583331latitude[latitude == "WM02"] = -31.47069latitude[latitude == "WM03"] = -31.639122latitude[latitude == "WM04"] = -32.8999964latitude[latitude == "WM05"] = -34.4666648 latitude[latitude == "WM06"] = -32.374331836 latitude[latitude == "WM07"] = -33.2166658 latitude[latitude == "WM08"] = -34.0027latitude[latitude == "WM09"] = -31.18736latitude[latitude == "WM10"] = -32.33083sample_Q$latitude=latitude#Longitude Componentlongitude = sample_Q$Station_IDlongitude[longitude == "WM01"] = 16.4833314longitude[longitude == "WM02"] = 19.77601longitude[longitude == "WM03"] = 18.5285longitude[longitude == "WM04"] = 17.9833294longitude[longitude == "WM05"] = 19.8999964longitude[longitude == "WM06"] = 20.806413441longitude[longitude == "WM07"] = 22.0333332longitude[longitude == "WM08"] = 24.7440longitude[longitude == "WM09"] = 24.94991longitude[longitude == "WM10"] = 28.14981sample_Q$longitude=longitude#Creating Meshes for Practical Selectionkk=ncol(sample_Q)sample_Q[, (kk-1):kk] <- sapply(sample_Q[, (kk-1):kk], as.numeric)sample_Q$lat_jit=jitter(sample_Q$latitude, factor = 1, amount = 0.65)sample_Q$lon_jit=jitter(sample_Q$longitude, factor = 1, amount = 0.65)sampleQ1 = sample_Q[complete.cases(sample_Q),]sample_Q <- sampleQ1# show map with Latitude 200 as centercc=ncol(sample_Q)coords <- cbind( as.matrix(sample_Q$lon_jit), as.matrix(sample_Q$lat_jit) )pl.dom <- cbind(c(15, 35), c(-35,-20))temp = sample_Q$Altitudesample_Q$Altitude = sample_Q$Yearsample_Q$Year = tempf_month <- sample_Q$Monthf_month[f_month == "JAN"] = 1f_month[f_month == "FEB"] = 2f_month[f_month == "MAR"] = 3f_month[f_month == "APR"] = 4f_month[f_month == "MAY"] = 5f_month[f_month == "JUN"] = 6f_month[f_month == "JUL"] = 7f_month[f_month == "AUG"] = 8f_month[f_month == "SEP"] = 9f_month[f_month == "OCT"] = 10f_month[f_month == "NOV"] = 11f_month[f_month == "DEC"] = 12direct=sample_Q$`Wind_Direct AVG`direct=direct*(pi/180)cos_direct=cos(direct)sin_direct=sin(direct)sample_Q$cos_direct=cos_directsample_Q$sin_direct=sin_directsample_Q$f_month = f_monthsample_Q$f_month=as.numeric(sample_Q$f_month)#Creating a cumulative Month Columnc_month1 <- sample_Q$Monthc_month2 =sample_Q$Yearc_month=c(NA, n = length(c_month1))#2011c_month[c_month1== "JAN" & c_month2==2011]=1c_month[c_month1== "FEB" & c_month2==2011]=2c_month[c_month1== "MAR" & c_month2==2011]=3c_month[c_month1== "APR" & c_month2==2011]=4c_month[c_month1== "MAY" & c_month2==2011]=5c_month[c_month1== "JUN" & c_month2==2011]=6c_month[c_month1== "JUL" & c_month2==2011]=7c_month[c_month1== "AUG" & c_month2==2011]=8c_month[c_month1== "SEP" & c_month2==2011]=9c_month[c_month1== "OCT" & c_month2==2011]=10c_month[c_month1== "NOV" & c_month2==2011]=11c_month[c_month1== "DEC" & c_month2==2011]=12#2012c_month[c_month1== "JAN" & c_month2==2012]=13c_month[c_month1== "FEB" & c_month2==2012]=14c_month[c_month1== "MAR" & c_month2==2012]=15c_month[c_month1== "APR" & c_month2==2012]=16c_month[c_month1== "MAY" & c_month2==2012]=17c_month[c_month1== "JUN" & c_month2==2012]=18c_month[c_month1== "JUL" & c_month2==2012]=19c_month[c_month1== "AUG" & c_month2==2012]=20c_month[c_month1== "SEP" & c_month2==2012]=21c_month[c_month1== "OCT" & c_month2==2012]=22c_month[c_month1== "NOV" & c_month2==2012]=23c_month[c_month1== "DEC" & c_month2==2012]=24#2013c_month[c_month1== "JAN" & c_month2==2013]=25c_month[c_month1== "FEB" & c_month2==2013]=26c_month[c_month1== "MAR" & c_month2==2013]=27c_month[c_month1== "APR" & c_month2==2013]=28c_month[c_month1== "MAY" & c_month2==2013]=29c_month[c_month1== "JUN" & c_month2==2013]=30c_month[c_month1== "JUL" & c_month2==2013]=31c_month[c_month1== "AUG" & c_month2==2013]=32c_month[c_month1== "SEP" & c_month2==2013]=33c_month[c_month1== "OCT" & c_month2==2013]=34c_month[c_month1== "NOV" & c_month2==2013]=35c_month[c_month1== "DEC" & c_month2==2013]=36#2014c_month[c_month1== "JAN" & c_month2==2014]=37c_month[c_month1== "FEB" & c_month2==2014]=38c_month[c_month1== "MAR" & c_month2==2014]=39c_month[c_month1== "APR" & c_month2==2014]=40c_month[c_month1== "MAY" & c_month2==2014]=41c_month[c_month1== "JUN" & c_month2==2014]=42c_month[c_month1== "JUL" & c_month2==2014]=43c_month[c_month1== "AUG" & c_month2==2014]=44c_month[c_month1== "SEP" & c_month2==2014]=45c_month[c_month1== "OCT" & c_month2==2014]=46c_month[c_month1== "NOV" & c_month2==2014]=47c_month[c_month1== "DEC" & c_month2==2014]=48#2015c_month[c_month1== "JAN" & c_month2==2015]=49c_month[c_month1== "FEB" & c_month2==2015]=50c_month[c_month1== "MAR" & c_month2==2015]=51c_month[c_month1== "APR" & c_month2==2015]=52c_month[c_month1== "MAY" & c_month2==2015]=53c_month[c_month1== "JUN" & c_month2==2015]=54c_month[c_month1== "JUL" & c_month2==2015]=55c_month[c_month1== "AUG" & c_month2==2015]=56c_month[c_month1== "SEP" & c_month2==2015]=57c_month[c_month1== "OCT" & c_month2==2015]=58c_month[c_month1== "NOV" & c_month2==2015]=59c_month[c_month1== "DEC" & c_month2==2015]=60#2016c_month[c_month1== "JAN" & c_month2==2016]=61c_month[c_month1== "FEB" & c_month2==2016]=62c_month[c_month1== "MAR" & c_month2==2016]=63c_month[c_month1== "APR" & c_month2==2016]=64c_month[c_month1== "MAY" & c_month2==2016]=65c_month[c_month1== "JUN" & c_month2==2016]=66c_month[c_month1== "JUL" & c_month2==2016]=67c_month[c_month1== "AUG" & c_month2==2016]=68c_month[c_month1== "SEP" & c_month2==2016]=69c_month[c_month1== "OCT" & c_month2==2016]=70c_month[c_month1== "NOV" & c_month2==2016]=71c_month[c_month1== "DEC" & c_month2==2016]=72#2017c_month[c_month1== "JAN" & c_month2==2017]=73c_month[c_month1== "FEB" & c_month2==2017]=74c_month[c_month1== "MAR" & c_month2==2017]=75c_month[c_month1== "APR" & c_month2==2017]=76c_month[c_month1== "MAY" & c_month2==2017]=77c_month[c_month1== "JUN" & c_month2==2017]=78c_month[c_month1== "JUL" & c_month2==2017]=79c_month[c_month1== "AUG" & c_month2==2017]=80c_month[c_month1== "SEP" & c_month2==2017]=81c_month[c_month1== "OCT" & c_month2==2017]=82c_month[c_month1== "NOV" & c_month2==2017]=83c_month[c_month1== "DEC" & c_month2==2017]=84#2018c_month[c_month1== "JAN" & c_month2==2018]=85c_month[c_month1== "FEB" & c_month2==2018]=86c_month[c_month1== "MAR" & c_month2==2018]=87c_month[c_month1== "APR" & c_month2==2018]=88c_month[c_month1== "MAY" & c_month2==2018]=89c_month[c_month1== "JUN" & c_month2==2018]=90c_month[c_month1== "JUL" & c_month2==2018]=91c_month[c_month1== "AUG" & c_month2==2018]=92c_month[c_month1== "SEP" & c_month2==2018]=93c_month[c_month1== "OCT" & c_month2==2018]=94c_month[c_month1== "NOV" & c_month2==2018]=95c_month[c_month1== "DEC" & c_month2==2018]=96#2019c_month[c_month1== "JAN" & c_month2==2019]=97c_month[c_month1== "FEB" & c_month2==2019]=98c_month[c_month1== "MAR" & c_month2==2019]=99c_month[c_month1== "APR" & c_month2==2019]=100c_month[c_month1== "MAY" & c_month2==2019]=101c_month[c_month1== "JUN" & c_month2==2019]=102c_month[c_month1== "JUL" & c_month2==2019]=103c_month[c_month1== "AUG" & c_month2==2019]=104c_month[c_month1== "SEP" & c_month2==2019]=105c_month[c_month1== "OCT" & c_month2==2019]=106c_month[c_month1== "NOV" & c_month2==2019]=107c_month[c_month1== "DEC" & c_month2==2019]=108#2020c_month[c_month1== "JAN" & c_month2==2020]=109c_month[c_month1== "FEB" & c_month2==2020]=110c_month[c_month1== "MAR" & c_month2==2020]=111c_month[c_month1== "APR" & c_month2==2020]=112c_month[c_month1== "MAY" & c_month2==2020]=113c_month[c_month1== "JUN" & c_month2==2020]=114c_month[c_month1== "JUL" & c_month2==2020]=115c_month[c_month1== "AUG" & c_month2==2020]=116c_month[c_month1== "SEP" & c_month2==2020]=117c_month[c_month1== "OCT" & c_month2==2020]=118c_month[c_month1== "NOV" & c_month2==2020]=119c_month[c_month1== "DEC" & c_month2==2020]=120#2021c_month[c_month1== "JAN" & c_month2==2021]=121c_month[c_month1== "FEB" & c_month2==2021]=122c_month[c_month1== "MAR" & c_month2==2021]=123c_month[c_month1== "APR" & c_month2==2021]=124c_month[c_month1== "MAY" & c_month2==2021]=125c_month[c_month1== "JUN" & c_month2==2021]=126c_month[c_month1== "JUL" & c_month2==2021]=127c_month[c_month1== "AUG" & c_month2==2021]=128c_month[c_month1== "SEP" & c_month2==2021]=129c_month[c_month1== "OCT" & c_month2==2021]=130c_month[c_month1== "NOV" & c_month2==2021]=131c_month[c_month1== "DEC" & c_month2==2021]=132sample_Q$c_month = c_monthf.s <- y ~ -1 + Intercept + f(altitude, model = "rw2") + f(f_month, model = "ar1")+f(c_month, model = "ar1")+ cos_d + sin_d + f(i, model=l.spde) y=as.numeric(sample_Q$Wind_Speed + 0.1)alt=as.matrix(sample_Q$Altitude)f_month=as.numeric(as.matrix(sample_Q$f_month))c_month=as.numeric(as.matrix(sample_Q$c_month))cos_d=as.matrix(sample_Q$cos_direct)sin_d=as.matrix(sample_Q$sin_direct)Intercept=rep(1,nrow(sample_Q))covars=as.matrix(cbind(sample_Q$lon_jit,                        sample_Q$lat_jit,                       alt,                       f_month,                       c_month,                       cos_d,                       sin_d))cn=c("long","lat","altitude", "f_month", "c_month", "cos_d", "sin_d")names(covars)=cnNsub=nrow(sample_Q)lrf <- inla_res <- l.dat <- l.spde <- l.a <- mesh.index <-dat <- list()  l.a<- inla.spde.make.A(mesh5, loc=coords)  l.spde <- inla.spde2.pcmatern(mesh5, alpha=2, prior.range = c(0.3, 0.5),                                # P(sigma > 1) = 0.01                                prior.sigma = c(10, 0.1))  mesh.index <- inla.spde.make.index(name = "field", n.spde = l.spde$n.spde)  l.dat <- inla.stack(    data = list(resp = y),    A = list(l.a, 1,1,1,1,1,1),     effects = list(i = 1:l.spde$n.spde,                   Intercept = Intercept,                   altitude=alt,                   f_month=f_month,                   c_month=c_month,                   cos_d=cos_d,                   sin_d=sin_d),    tag = 'est')  dat <- inla.stack.data(l.dat)    inla_res <- inla(f.s, family = "Weibull", data = dat, control.inla = list(cmin=0),                    control.predictor=list(A=inla.stack.A(l.dat),compute=TRUE),                    control.compute = list(dic=TRUE, waic=TRUE,cpo=TRUE, save.memory = TRUE),                    inla.mode = "experimental", verbose = T)  lrf <- inla.spde2.result(inla_res, 'i', l.spde, do.transf=TRUE)save(inla_res, mesh5, lrf, file = "Wind2.RData")  setwd("~/Documents")load("Wind2.RData")result1=inla_ressummary(result1)result1_lrf=lrfsummary(result1_lrf)k=5e_col="black"getmode <- function(v) {  uniqv <- unique(v)  uniqv[which.max(tabulate(match(v, uniqv)))]}### SPATIAL PARMS#SIGMA2Es2.marg <- inla.tmarginal(function(x) 1/x, result1$marginals.hy[[1]])s2.est=modal(s2.marg[,1])xrange <- range(s2.marg[,1])yrange <- range(s2.marg[,2])plot.default(s2.marg, type='l', xlim=xrange, ylim=yrange,             xlab=expression(sigma[e]^2), ylab='Density', col=e_col, lwd=3,             main="SigmaE Estimate")abline(v=s2.est,col="Red",lwd=2)#SIGMA2xs2x.est = modal(result1_lrf$marginals.variance.nominal[[1]][,1])xrange <- range(result1_lrf$marginals.variance.nominal[[1]][,1])yrange <- range(result1_lrf$marginals.variance.nominal[[1]][,2])plot(result1_lrf$marginals.variance.nominal[[1]], type='l',     xlim=xrange, ylim=yrange, xlab=expression(sigma[x]^2), ylab='Density', col=e_col, lwd=3,     main="SigmaX Estimate")abline(v=s2x.est,col="Red",lwd=2)#KAPPAkappa.est = modal(result1_lrf$marginals.kappa[[1]][,1])xrange <- range(result1_lrf$marginals.kappa[[1]][,1])yrange <- range(result1_lrf$marginals.kappa[[1]][,2])plot(result1_lrf$marginals.kappa[[1]], type='l',     xlim=xrange, ylim=yrange, xlab=expression(kappa), ylab='Density', col=e_col, lwd=3,     main="Kappa Estimate")abline(v=kappa.est,col="Red",lwd=2)#NOMINAL RANGEnran.est=modal(result1_lrf$marginals.range.nominal[[1]][,1])xrange <- range(result1_lrf$marginals.range.nominal[[1]][,1])yrange <- range(result1_lrf$marginals.range.nominal[[1]][,2])plot(result1_lrf$marginals.range.nominal[[1]], type='l',     xlim=xrange, ylim=yrange, xlab='nominal range', ylab='Density', col=e_col, lwd=3,     main="Nominal Range Estimate")abline(v=nran.est,col="Red",lwd=2)#TAUtau.est=modal(result1_lrf$marginals.tau[[1]][,1])xrange <- range(result1_lrf$marginals.tau[[1]][,1])yrange <- range(result1_lrf$marginals.tau[[1]][,2])plot(result1_lrf$marginals.tau[[1]], type='l',     xlim=xrange, ylim=yrange, xlab=expression(tau), ylab='Density', col=e_col, lwd=3,     main="Tau Estimate")abline(v=tau.est,col="Red",lwd=2)###SPAT RESres_spat=cbind(s2.est,s2x.est,kappa.est,nran.est,tau.est)### FIXED PARMS#BETA0beta0_est=result1$summary.fixed[1,6]xrange <- range(result1$marginals.fixed[[1]][,1])yrange <- range(result1$marginals.fixed[[1]][,2])plot(result1$marginals.fix[[1]], type='l', xlim=xrange, ylim=yrange,     xlab=expression(beta[0]), ylab='Density', col="red", lwd=3,     main="Intercept Estimate")abline(v=beta0_est,col="Blue",lwd=2)#COS cos_est=result1$summary.fixed[2,6]xrange <- range(result1$marginals.fixed[[2]][,1])yrange <- range(result1$marginals.fixed[[2]][,2])plot(result1$marginals.fix[[2]], type='l', xlim=xrange, ylim=yrange,     xlab=expression(beta[cos]), ylab='Density', col="red", lwd=3,     main="Cosine Estimate")abline(v=cos_est,col="Blue",lwd=2)#SIN sin_est=result1$summary.fixed[3,6]xrange <- range(result1$marginals.fixed[[3]][,1])yrange <- range(result1$marginals.fixed[[3]][,2])plot(result1$marginals.fix[[3]], type='l', xlim=xrange, ylim=yrange,     xlab=expression(beta[sin]), ylab='Density', col="red", lwd=3,     main="Sine Estimate")abline(v=sin_est,col="Blue",lwd=2)##Fixed Resres_fix=cbind(beta0_est,cos_est,sin_est)### RANDOM EFFECTS# ALTITUDE: RANDOM EFFECTplot(result1$summary.random$altitude[,1],     result1$summary.random$altitude[,2], type = "l",     main= "Summarising the Random Altitude Effect",     xlab= "Altitude in Meters",     ylab= "Random Effect",     lwd=3)lines(result1$summary.random$altitude[,1],result1$summary.random$altitude[,4], col="Red", lwd=2)lines(result1$summary.random$altitude[,1],result1$summary.random$altitude[,6], col="Red", lwd=2)legend("topright", legend=c("0.975 Credible Interval", "Mean","0.025 Credible Interval"),       col=c("red", "black","red"), lty=1:2, cex=0.8)# F_MONTH: RANDOM EFFECTyrange1=min(result1$summary.random$f_month[,4])yrange2=max(result1$summary.random$f_month[,6])yrange=range(yrange1,yrange2)plot(result1$summary.random$f_month[,1],     result1$summary.random$f_month[,2], type = "l",     main= "Summarising the Repeating Random Month Effect",     xlab= "Months in a Single Year",     ylab= "Random Effect",     lwd=3,     ylim=yrange)lines(result1$summary.random$f_month[,1],result1$summary.random$f_month[,4],       col="Red", lwd=2)lines(result1$summary.random$f_month[,1],result1$summary.random$f_month[,6],       col="Red", lwd=2)legend("topright", legend=c("0.975 Credible Interval", "Mean","0.025 Credible Interval"),       col=c("red", "black","red"), lty=1:2, cex=0.8)# C_MONTH: RANDOM EFFECTyrange1=min(result1$summary.random$c_month[,4])yrange2=max(result1$summary.random$c_month[,6])yrange=range(yrange1,yrange2)plot(result1$summary.random$c_month[,1],     result1$summary.random$c_month[,2], type = "l",     main= "Summarising the Cumulative Random Month Effect",     xlab= "Months in a Single Year",     ylab= "Random Effect",     lwd=3,     ylim=yrange)lines(result1$summary.random$c_month[,1],result1$summary.random$c_month[,4],       col="Red", lwd=2)lines(result1$summary.random$c_month[,1],result1$summary.random$c_month[,6],       col="Red", lwd=2)legend("topright", legend=c("0.975 Credible Interval", "Mean","0.025 Credible Interval"),       col=c("red", "black","red"), lty=1:2, cex=0.8)### HYPER PARAMETERS#WEIBULL ALPHAest_alpha=result1$summary.hyperpar$mode[1]plot(result1$marginals.hyperpar$`alpha parameter for weibull`, type = "l",col="purple",     main= "Hyperparameter Posterior Density Function: Weibull Shape Parameter",     lwd=3,     xlab=expression(alpha),     ylab="Density")abline(v=est_alpha,col="Red", lwd=2)#ALTITUDE PRECISIONest_palt=result1$summary.hyperpar$'0.5quant'[2]plot(result1$marginals.hyperpar$`Precision for altitude`, type = "l",col="purple",     main= "Hyperparameter Posterior Density Function: Precision for Altitude ",     lwd=3,     xlab=expression(Sigma),     ylab="Density")abline(v=est_palt,col="Red", lwd=2)#F_MONTH PRECISIONest_pfmonth=result1$summary.hyperpar$'0.5quant'[3]plot(result1$marginals.hyperpar$`Precision for f_month`, type = "l",col="purple",     main= "Hyperparameter Posterior Density Function: Repeating Month Precision",     lwd=3,     xlab=expression(Sigma),     ylab="Density")abline(v=est_pfmonth,col="Red", lwd=2)#F_MONTH RHOest_rhofmonth=result1$summary.hyperpar$mode[4]plot(result1$marginals.hyperpar$`Rho for f_month`, type = "l",col="purple",     main= "Hyperparameter Posterior Density Function: Repeating Month Rho",     lwd=3,     xlab=expression(rho),     ylab="Density")abline(v=est_rhofmonth,col="Red", lwd=2)#C_MONTH PRECISIONest_pcmonth=result1$summary.hyperpar$mode[5]plot(result1$marginals.hyperpar$`Precision for c_month`, type = "l",col="purple",     main= "Hyperparameter Posterior Density Function: Cumulative Month Precision",     lwd=3,     xlab=expression(Sigma),     ylab="Density")abline(v=est_pcmonth,col="Red", lwd=2)#C_MONTH RHOest_rhocmonth=result1$summary.hyperpar$mode[6]plot(result1$marginals.hyperpar$`Rho for c_month`, type = "l",col="purple",     main= "Hyperparameter Posterior Density Function: Cumulative Month Rho",     lwd=3,     xlab=expression(rho),     ylab="Density")abline(v=est_rhocmonth,col="Red", lwd=2)## Hyperpar Resres_hyp=cbind(est_alpha,est_palt,est_pfmonth,est_rhofmonth,est_pcmonth,est_rhocmonth)res_spatres_fixres_hyp#######################################HEAT MAP#Project SPDE onto the SA map### projector to a grid world <- ne_countries(scale = "medium", returnclass = "sf" )world <- world[world$name == "South Africa",]Latitude = c(-28.583331, -31.47069 , 	-31.639122, -32.8999964 ,-34.4666648 ,-32.374331836 ,-33.2166658 ,-34.0027,-31.18736 ,-32.33083 )Longitude = c(16.4833314,19.77601,18.5285, 17.9833294,  19.8999964, 20.806413441, 22.0333332, 24.7440,24.94991, 28.14981)Site=c("WM01","WM02","WM03","WM04","WM05","WM06","WM07","WM08","WM09","WM10")site_locat <- data.frame(Site, Latitude, Longitude)leaflet(world) %>% addTiles() %>%  addMarkers(lng = site_locat[,3], lat = site_locat[,2], label = site_locat[,1])r = result1bbnw <- matrix(c(16.44756, -46.96289, 37.8877, -22.14629),               byrow = FALSE, nrow = 2)msh=mesh5 #MESHE=MESH5bbnw <- bbox(as_Spatial(st_geometry(world)))bbnwr0 <- diff(range(bbnw[1, ])) / diff(range(bbnw[2, ]))r0prj <- inla.mesh.projector(msh, xlim = bbnw[1, ],                            ylim = bbnw[2, ], dims = round(c(r0, 1)*300))## NA's were not to plot spat.m <- inla.mesh.project(prj, r$summary.random$i$mean)spat.sd <- inla.mesh.project(prj, r$summary.random$i$sd)spp <- sf::as_Spatial(st_geometry(world))crs(spp) <- NAov <- over(SpatialPoints(prj$lattice$loc), spp)spat.sd[is.na(ov)] <- NAspat.m[is.na(ov)] <- NApar(mfrow = c(1,1), mar = c(0.1,0.1,0.1,0.1))plot(spp, xlim = c(28,28.5), ylim = c(-35,-22))title('Heat Map based on MESH_E',line=-1.5)image.plot(x = prj$x, y = prj$y, z = spat.m, add = TRUE)points(x = site_locat[,3], y = site_locat[,2], cex = 1, pch = 8)par(mfrow = c(1,1), mar = c(0.1,0.1,0.1,0.1))plot(spp, xlim = c(28,28.5), ylim = c(-35,-22))title('Heat Map based on MESH_E',line=-1.5)image.plot(x = prj$x, y = prj$y, z = spat.sd, add = TRUE)points(x = site_locat[,3], y = site_locat[,2], cex = 1, pch = 8)##########################################MODEL ASSESSMENT CRITERIA#BUILDING EACH MODEL#FULL MODEL:form1=y ~ -1 + Intercept +  f(i, model=l.spde[[k]])form2=y ~ -1 + Intercept +  f(i, model=l.spde[[k]]) + f(altitude, model = "rw2")form3=y ~ -1 + Intercept +  f(i, model=l.spde[[k]]) + f(altitude, model = "rw2") + f(f_month, model = "ar1")form4=y ~ -1 + Intercept +  f(i, model=l.spde[[k]]) + f(altitude, model = "rw2") + f(f_month, model = "ar1")+f(c_month, model = "ar1")form5=y ~ -1 + Intercept +  f(i, model=l.spde[[k]]) + f(altitude, model = "rw2")+ f(f_month, model = "ar1")+f(c_month, model = "ar1")  + cos_dform6=y ~ -1 + Intercept +  f(i, model=l.spde[[k]]) + f(altitude, model = "rw2")+ f(f_month, model = "ar1")+f(c_month, model = "ar1")+ cos_d + sin_dnform=6#MESH_Emesh_use <- inla.mesh.2d(loc.domain = pl.dom,coords, max.edge = c(0.55, 0.55), offset = c(0.15, 0.15), cutoff = c(0.55))plot(mesh_use)points(coords, col = "red", pch = 16)lrf <- inla_res <- l.dat <- l.spde <- l.a <- mesh.index <-dat<-form <- list()for (k in 1:6) {  l.a[[k]] <- inla.spde.make.A(mesh_use, loc=coords)  l.spde[[k]] <- inla.spde2.matern(mesh_use, alpha=2)  mesh.index[[k]] <- inla.spde.make.index(name = "field", n.spde = l.spde[[k]]$n.spde)  l.dat[[k]] <- inla.stack(    data = list(resp = y),    A = list(l.a[[k]], 1,1,1,1,1,1),     effects = list(i = 1:l.spde[[k]]$n.spde,                   Intercept = Intercept,                   altitude=alt,                   f_month=f_month,                   c_month=c_month,                   cos_d=cos_d,                   sin_d=sin_d),    tag = 'est')  dat[[k]] <- inla.stack.data(l.dat[[k]])  form[[k]] <- get(paste('form', k, sep=''))  inla_res[[k]] <- inla(formula = form[[k]], family = "Weibull", data = dat[[k]], verbose = TRUE, control.inla = list(cmin=0),                        control.predictor=list(A=inla.stack.A(l.dat[[k]]),compute=TRUE),                        control.compute = list(dic=TRUE, waic=TRUE,cpo=TRUE),                        inla.mode = "experimental")  lrf[[k]] <- inla.spde2.result(inla_res[[k]], 'i', l.spde[[k]], do.transf=TRUE)}reduced_model_res=inla_res#WAIC MATRIXres_WAIC=matrix(nrow = nform, ncol = 1, NA)for (k in 1:nform) {  res_WAIC[k]=reduced_model_res[[k]]$waic$waic}res_WAIC#WAIC PLOTform_trk=c("SM1", "SM2","SM3","SM4","SM5","Spatial-Model1")NUM_form=c(1:nform)waic_plt=as.data.frame(cbind(NUM_form,res_WAIC))yrange <- range(res_WAIC)plot(waic_plt$V2, type='l', xaxt="n",     ylim=yrange, xlab="Model", ylab='WAIC', col="orange", lwd=3,     main="WAIC for Each Model")axis(side = 1, at = 1:nform, labels = c("SM1", "SM2","SM3","SM4","SM5","Spatial-Model1"))#DIC MATRIXres_DIC=matrix(nrow = nform, ncol = 1, NA)for (k in 1:nform) {  res_DIC[k]=reduced_model_res[[k]]$dic$dic}res_DIC#DIC PLOTform_trk=c("SM1", "SM2","SM3","SM4","SM5","Spatial-Model1")NUM_form=c(1:nform)dic_plt=as.data.frame(cbind(NUM_form,res_DIC))yrange <- range(res_DIC)plot(dic_plt$V2, type='l', xaxt="n",     ylim=yrange, xlab="Model", ylab='WAIC', col="orange", lwd=3,     main="DIC for Each Model")axis(side = 1, at = 1:nform, labels = c("SM1", "SM2","SM3","SM4","SM5","Spatial-Model1"))